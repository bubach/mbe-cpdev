<?php eval("?>".base64_decode("PD9waHANCg0KLyoqDQogKiBQcm9kdWN0IFVybCBtb2RlbA0KICoNCiAqIEBjYXRlZ29yeSAgIFNjb21tZXJjZQ0KICogQHBhY2thZ2UgICAgU2NvbW1lcmNlX0NhdGFsb2dVcmwNCiAqIEBhdXRob3IgICAgIFNjb21tZXJjZSBNYWdlIDxjb3JlQHNjb21tZXJjZS1tYWdlLmNvLnVrPg0KICovDQpjbGFzcyBTY29tbWVyY2VfQ2F0YWxvZ1VybF9Nb2RlbF9Qcm9kdWN0X1VybCBleHRlbmRzIE1hZ2VfQ2F0YWxvZ19Nb2RlbF9Qcm9kdWN0X1VybA0Kew0KICAgIC8qKg0KICAgICAqIENoZWNrIHByb2R1Y3QgY2F0ZWdvcnkNCiAgICAgKg0KICAgICAqIEBwYXJhbSBNYWdlX0NhdGFsb2dfTW9kZWxfUHJvZHVjdCAkcHJvZHVjdA0KICAgICAqIEBwYXJhbSBhcnJheSAkcGFyYW1zDQogICAgICoNCiAgICAgKiBAcmV0dXJuIGludHxudWxsDQogICAgICovDQogICAgcHJvdGVjdGVkIGZ1bmN0aW9uIF9nZXRDYXRlZ29yeUlkRm9yVXJsKCRwcm9kdWN0LCAkcGFyYW1zKQ0KICAgIHsNCgkJaWYgKCFNYWdlOjpoZWxwZXIoInNjb21tZXJjZV9jYXRhbG9ndXJsIiktPmdldEVuYWJsZSgpKSByZXR1cm4gcGFyZW50OjpfZ2V0Q2F0ZWdvcnlJZEZvclVybCgkcHJvZHVjdCwgJHBhcmFtcyk7DQogICAgICAgIGlmIChpc3NldCgkcGFyYW1zWydfaWdub3JlX2NhdGVnb3J5J10pIHx8IE1hZ2U6OmhlbHBlcigic2NvbW1lcmNlX2NhdGFsb2d1cmwiKS0+Z2V0UmVtb3ZlQ2F0UGF0aCgpKSB7DQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRjYXRlZ29yeWlkID0gJHByb2R1Y3QtPmdldENhdGVnb3J5SWQoKSAmJiAhJHByb2R1Y3QtPmdldERvTm90VXNlQ2F0ZWdvcnlJZCgpDQogICAgICAgICAgICAgICAgPyAkcHJvZHVjdC0+Z2V0Q2F0ZWdvcnlJZCgpIDogbnVsbDsNCgkJCQ0KCQkJJHN0b3JlSWQgPSAwOw0KCQkJaWYgKGlzc2V0KCRwYXJhbXNbJ19zdG9yZSddKSkgew0KCQkJCSRzdG9yZUlkID0gJHRoaXMtPl9nZXRTdG9yZUlkKCRwYXJhbXNbJ19zdG9yZSddKTsNCgkJCX0gZWxzZSB7DQoJCQkJJHN0b3JlSWQgPSAkcHJvZHVjdC0+Z2V0U3RvcmVJZCgpOw0KCQkJfQ0KCQkJDQoJCQkkcHJpbWFyeV9jYXRlZ29yeSA9IE1hZ2U6OmdldFJlc291cmNlTW9kZWwoJ2NhdGFsb2cvcHJvZHVjdCcpLT5nZXRBdHRyaWJ1dGVSYXdWYWx1ZSgkcHJvZHVjdC0+Z2V0SWQoKSwgJ3Byb2R1Y3RfcHJpbWFyeV9jYXRlZ29yeScsICRzdG9yZUlkKTsNCgkJCQ0KCQkJaWYgKCEkcHJpbWFyeV9jYXRlZ29yeSl7DQoJCQkJcmV0dXJuICRjYXRlZ29yeWlkOw0KCQkJfQ0KCQkJZWxzZWlmICgoaW50KSRjYXRlZ29yeWlkICE9PSAoaW50KSRwcmltYXJ5X2NhdGVnb3J5KXsNCgkJCQlyZXR1cm4gJHByaW1hcnlfY2F0ZWdvcnk7DQoJCQl9DQoJCQllbHNlew0KCQkJCXJldHVybiAkY2F0ZWdvcnlpZDsNCgkJCX0NCiAgICAgICAgfQ0KICAgIH0NCgkNCgkvKioNCiAgICAgKiBSZXRyaWV2ZSBQcm9kdWN0IFVSTCB1c2luZyBVcmxEYXRhT2JqZWN0DQogICAgICoNCiAgICAgKiBAcGFyYW0gTWFnZV9DYXRhbG9nX01vZGVsX1Byb2R1Y3QgJHByb2R1Y3QNCiAgICAgKiBAcGFyYW0gYXJyYXkgJHBhcmFtcw0KICAgICAqIEByZXR1cm4gc3RyaW5nDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIGdldFVybChNYWdlX0NhdGFsb2dfTW9kZWxfUHJvZHVjdCAkcHJvZHVjdCwgJHBhcmFtcyA9IGFycmF5KCkpDQogICAgew0KCQlpZiAoIU1hZ2U6OmhlbHBlcigic2NvbW1lcmNlX2NhdGFsb2d1cmwiKS0+Z2V0RW5hYmxlKCkpIHJldHVybiBwYXJlbnQ6OmdldFVybCgkcHJvZHVjdCwgJHBhcmFtcyk7DQoJCWlmICh2ZXJzaW9uX2NvbXBhcmUoTWFnZTo6Z2V0VmVyc2lvbigpLCAnMS44LjAuMCcsICc8Jyk9PT10cnVlICYmIHZlcnNpb25fY29tcGFyZShNYWdlOjpnZXRWZXJzaW9uKCksICcxLjQuMC4wJywgJz4nKT09PXRydWUpIHsJCQ0KCQkJJHJvdXRlUGF0aCAgICAgID0gJyc7DQoJCQkkcm91dGVQYXJhbXMgICAgPSAkcGFyYW1zOw0KDQoJCQkkc3RvcmVJZCAgICA9ICRwcm9kdWN0LT5nZXRTdG9yZUlkKCk7DQoJCQlpZiAoaXNzZXQoJHBhcmFtc1snX2lnbm9yZV9jYXRlZ29yeSddKSkgew0KCQkJCXVuc2V0KCRwYXJhbXNbJ19pZ25vcmVfY2F0ZWdvcnknXSk7DQoJCQkJJGNhdGVnb3J5SWQgPSBudWxsOw0KCQkJfSBlbHNlIHsNCgkJCQkkY2F0ZWdvcnlJZCA9ICR0aGlzLT5fZ2V0Q2F0ZWdvcnlJZEZvclVybCgkcHJvZHVjdCwgJHBhcmFtcyk7DQoJCQl9DQoJCQkNCgkJCWlmICgkcHJvZHVjdC0+aGFzVXJsRGF0YU9iamVjdCgpKSB7DQoJCQkJJHJlcXVlc3RQYXRoID0gJHByb2R1Y3QtPmdldFVybERhdGFPYmplY3QoKS0+Z2V0VXJsUmV3cml0ZSgpOw0KCQkJCSRyb3V0ZVBhcmFtc1snX3N0b3JlJ10gPSAkcHJvZHVjdC0+Z2V0VXJsRGF0YU9iamVjdCgpLT5nZXRTdG9yZUlkKCk7DQoJCQl9DQoJCQllbHNlIHsNCgkJCQkkcmVxdWVzdFBhdGggPSAnJzsNCgkJCQlpZiAoZW1wdHkoJHJlcXVlc3RQYXRoKSkgew0KCQkJCQkkaWRQYXRoID0gc3ByaW50ZigncHJvZHVjdC8lZCcsICRwcm9kdWN0LT5nZXRFbnRpdHlJZCgpKTsNCgkJCQkJaWYgKCRjYXRlZ29yeUlkKSB7DQoJCQkJCQkkaWRQYXRoID0gc3ByaW50ZignJXMvJWQnLCAkaWRQYXRoLCAkY2F0ZWdvcnlJZCk7DQoJCQkJCX0NCgkJCQkJJHJld3JpdGUgPSAkdGhpcy0+Z2V0VXJsUmV3cml0ZSgpOw0KCQkJCQkkcmV3cml0ZS0+c2V0U3RvcmVJZCgkc3RvcmVJZCkNCgkJCQkJCS0+bG9hZEJ5SWRQYXRoKCRpZFBhdGgpOw0KCQkJCQlpZiAoJHJld3JpdGUtPmdldElkKCkpIHsNCgkJCQkJCSRyZXF1ZXN0UGF0aCA9ICRyZXdyaXRlLT5nZXRSZXF1ZXN0UGF0aCgpOw0KCQkJCQkJJHByb2R1Y3QtPnNldFJlcXVlc3RQYXRoKCRyZXF1ZXN0UGF0aCk7DQoJCQkJCX0NCgkJCQl9DQoJCQl9DQoNCgkJCWlmIChpc3NldCgkcm91dGVQYXJhbXNbJ19zdG9yZSddKSkgew0KCQkJCSRzdG9yZUlkID0gTWFnZTo6YXBwKCktPmdldFN0b3JlKCRyb3V0ZVBhcmFtc1snX3N0b3JlJ10pLT5nZXRJZCgpOw0KCQkJfQ0KDQoJCQlpZiAoJHN0b3JlSWQgIT0gTWFnZTo6YXBwKCktPmdldFN0b3JlKCktPmdldElkKCkpIHsNCgkJCQkkcm91dGVQYXJhbXNbJ19zdG9yZV90b191cmwnXSA9IHRydWU7DQoJCQl9DQoNCgkJCWlmICghZW1wdHkoJHJlcXVlc3RQYXRoKSkgew0KCQkJCSRyb3V0ZVBhcmFtc1snX2RpcmVjdCddID0gJHJlcXVlc3RQYXRoOw0KCQkJfQ0KCQkJZWxzZSB7DQoJCQkJJHJvdXRlUGF0aCA9ICdjYXRhbG9nL3Byb2R1Y3Qvdmlldyc7DQoJCQkJJHJvdXRlUGFyYW1zWydpZCddICA9ICRwcm9kdWN0LT5nZXRJZCgpOw0KCQkJCSRyb3V0ZVBhcmFtc1sncyddICAgPSAkcHJvZHVjdC0+Z2V0VXJsS2V5KCk7DQoJCQkJaWYgKCRjYXRlZ29yeUlkKSB7DQoJCQkJCSRyb3V0ZVBhcmFtc1snY2F0ZWdvcnknXSA9ICRjYXRlZ29yeUlkOw0KCQkJCX0NCgkJCX0NCg0KCQkJLy8gcmVzZXQgY2FjaGVkIFVSTCBpbnN0YW5jZSBHRVQgcXVlcnkgcGFyYW1zDQoJCQlpZiAoIWlzc2V0KCRyb3V0ZVBhcmFtc1snX3F1ZXJ5J10pKSB7DQoJCQkJJHJvdXRlUGFyYW1zWydfcXVlcnknXSA9IGFycmF5KCk7DQoJCQl9DQoNCgkJCXJldHVybiAkdGhpcy0+Z2V0VXJsSW5zdGFuY2UoKS0+c2V0U3RvcmUoJHN0b3JlSWQpDQoJCQkJLT5nZXRVcmwoJHJvdXRlUGF0aCwgJHJvdXRlUGFyYW1zKTsNCgkJfQ0KCQllbHNlew0KCQkJJHVybCA9ICRwcm9kdWN0LT5nZXREYXRhKCd1cmwnKTsNCgkJCWlmICghZW1wdHkoJHVybCkpIHsNCgkJCQlyZXR1cm4gJHVybDsNCgkJCX0NCgkJCSRyZXF1ZXN0UGF0aCA9ICcnOw0KCQkJaWYgKGVtcHR5KCRyZXF1ZXN0UGF0aCkpIHsNCgkJCQkkcmVxdWVzdFBhdGggPSAkdGhpcy0+X2dldFJlcXVlc3RQYXRoKCRwcm9kdWN0LCAkdGhpcy0+X2dldENhdGVnb3J5SWRGb3JVcmwoJHByb2R1Y3QsICRwYXJhbXMpKTsNCgkJCQkkcHJvZHVjdC0+c2V0UmVxdWVzdFBhdGgoJHJlcXVlc3RQYXRoKTsNCgkJCX0NCg0KCQkJaWYgKGlzc2V0KCRwYXJhbXNbJ19zdG9yZSddKSkgew0KCQkJCSRzdG9yZUlkID0gJHRoaXMtPl9nZXRTdG9yZUlkKCRwYXJhbXNbJ19zdG9yZSddKTsNCgkJCX0gZWxzZSB7DQoJCQkJJHN0b3JlSWQgPSAkcHJvZHVjdC0+Z2V0U3RvcmVJZCgpOw0KCQkJfQ0KDQoJCQlpZiAoJHN0b3JlSWQgIT0gJHRoaXMtPl9nZXRTdG9yZUlkKCkpIHsNCgkJCQkkcGFyYW1zWydfc3RvcmVfdG9fdXJsJ10gPSB0cnVlOw0KCQkJfQ0KDQoJCQkvLyByZXNldCBjYWNoZWQgVVJMIGluc3RhbmNlIEdFVCBxdWVyeSBwYXJhbXMNCgkJCWlmICghaXNzZXQoJHBhcmFtc1snX3F1ZXJ5J10pKSB7DQoJCQkJJHBhcmFtc1snX3F1ZXJ5J10gPSBhcnJheSgpOw0KCQkJfQ0KDQoJCQkkdGhpcy0+Z2V0VXJsSW5zdGFuY2UoKS0+c2V0U3RvcmUoJHN0b3JlSWQpOw0KCQkJJHByb2R1Y3RVcmwgPSAkdGhpcy0+X2dldFByb2R1Y3RVcmwoJHByb2R1Y3QsICRyZXF1ZXN0UGF0aCwgJHBhcmFtcyk7DQoJCQkkcHJvZHVjdC0+c2V0RGF0YSgndXJsJywgJHByb2R1Y3RVcmwpOw0KCQkJcmV0dXJuICRwcm9kdWN0LT5nZXREYXRhKCd1cmwnKTsNCgkJfQ0KICAgIH0NCg0KfQ0K")); ?>